(function(a){a.mbTabset={mbTabsetArray:[],options:{container:"",item:"a",sortable:true,position:"left",start:function(){},stop:function(){}},build:function(b){this.each(function(){a(this).addClass("mbTabset");var g={};a.extend(g,a.mbTabset.options);var f={el:a(this)};a.extend(g,f);a.extend(g,b);a(this).addClass(g.position);var c=a(this).attr("id")+"_container";a(this).after("<div class='mbTabsetContainer' id='"+c+"'></div>");var d=a("#"+c);this.opt=g;a(this).find(g.item+":first").addClass("sel");var e=a(this).find(g.item);if(a.metadata){a.metadata.setType("class");a(e).each(function(){if(a(this).metadata().content){a(this).attr("content",a(this).metadata().content)}if(a(this).metadata().ajaxContent){a(this).attr("ajaxContent",a(this).metadata().ajaxContent)}if(a(this).metadata().ajaxdata){a(this).attr("ajaxdata",a(this).metadata().ajaxdata)}})}a(e).each(function(l){if(a(this).attr("ajaxContent")){if(a("#"+a(this).attr("content")).html()==null){d.append("<div id='"+a(this).attr("content")+"'> aaa</div>")}var k=(!a(this).attr("data"))?"":a(this).attr("data");var j=a("#"+a(this).attr("content"));a.ajax({type:"POST",url:a(this).attr("ajaxContent"),async:true,data:k,success:function(i){j.html(i)}})}a(this).addClass("mbTab");a(this).wrapInner("<span></span>");var h=a("#"+a(this).attr("content"));h.addClass("tabContent");d.append(h);h.hide();if(a(this).hasClass("sel")){h.fadeIn()}a(this).bind("click",function(){if(a(this).is(".disabled , .sel")){return}var m=a(this);var i="";a(e).each(function(){if(a(this).is(".sel")){i=a(this).attr("content");a(this).removeClass("sel")}});a("#"+i).fadeOut("fast",function(){m.addClass("sel");a("#"+m.attr("content")).slideDown("fast")})})});if(g.sortable){a(this).setSortableMbTabset(g)}})},toArray:function(b){return a(b).sortable("toArray")},actual:false,select:function(){},setSortable:function(c){if(!c){c=a(this)[0].opt}var b=a(this).find(c.item);a(b).each(function(){a(this).find("span").prepend("<i>&nbsp;</i>").addClass("sortable");a(this).find("i").bind("click",function(d){d.preventDefault();return false})});a(this).sortable({item:".tab",handle:"i",cursor:"move",revert:false,axis:"x",opacity:0.7,forcePlaceholderSize:true,start:function(){a(this).find(".tab").addClass("floatEl");if(c.start){c.start()}},stop:function(d){a(this).find(".tab").removeClass("floatEl");a.mbTabset.mbTabsetArray=a.mbTabset.toArray(a(this));if(c.stop){c.stop()}}})},clearSortable:function(c){if(!c){c=a(this)[0].opt}var b=a(this).find(c.item);a(b).each(function(){a(this).find("span").removeClass("sortable");a(this).find("i").remove()});a(this).sortable("destroy")}};a.fn.setSortableMbTabset=a.mbTabset.setSortable;a.fn.clearSortableMbTabset=a.mbTabset.clearSortable;a.fn.buildMbTabset=a.mbTabset.build;a.fn.serializeMbTabset=a.mbTabset.serialize})(jQuery);
